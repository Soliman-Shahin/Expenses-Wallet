<div class="balance-summary transaction-item" [class.is-loading]="isLoading">
  <button
    type="button"
    class="toggle-visibility"
    [attr.aria-label]="
      showBalance
        ? ('HOME.HIDE_BALANCE' | translate)
        : ('HOME.SHOW_BALANCE' | translate)
    "
    (click)="toggleBalance()"
  >
    <ion-icon
      [name]="showBalance ? 'eye-off-outline' : 'eye-outline'"
    ></ion-icon>
  </button>

  <ng-container *ngIf="!isLoading; else loadingState">
    <div
      class="total-balance"
      aria-live="polite"
      aria-labelledby="balance-heading"
      aria-describedby="balance-desc"
    >
      <span class="amount">{{ formattedBalance }}</span>
      <ion-badge
        *ngIf="percentageChange !== null"
        [color]="percentageChange >= 0 ? 'success' : 'danger'"
        [attr.aria-label]="
          percentageChange >= 0
            ? ('HOME.POSITIVE_CHANGE'
              | translate : { value: (percentageChange | number : '1.0-1') })
            : ('HOME.NEGATIVE_CHANGE'
              | translate : { value: (percentageChange | number : '1.0-1') })
        "
      >
        {{ percentageChange | number : "1.0-1" }}%
      </ion-badge>
    </div>
    <span id="balance-desc" class="visually-hidden">{{
      "HOME.BALANCE_DESCRIPTION" | translate
    }}</span>

    <ion-grid>
      <ion-row>
        <ion-col size="6" class="ion-no-padding">
          <div class="balance-item income">
            <ion-icon
              name="arrow-up-circle-outline"
              color="success"
              [attr.aria-label]="'HOME.INCOME' | translate"
            ></ion-icon>
            <div class="item-details">
              <span class="label">{{ "HOME.INCOME" | translate }}</span>
              <span class="amount">{{ formattedIncome }}</span>
            </div>
          </div>
        </ion-col>
        <ion-col size="6" class="ion-no-padding">
          <div class="balance-item expenses">
            <ion-icon
              name="arrow-down-circle-outline"
              color="danger"
              [attr.aria-label]="'HOME.EXPENSES' | translate"
            ></ion-icon>
            <div class="item-details">
              <span class="label">{{ "HOME.EXPENSES" | translate }}</span>
              <span class="amount">{{ formattedExpenses }}</span>
            </div>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ng-container>

  <ng-template #loadingState>
    <div class="total-balance">
      <ion-skeleton-text
        animated
        style="width: 60%; height: 40px"
        class="fade-in"
      ></ion-skeleton-text>
    </div>
    <ion-grid>
      <ion-row>
        <ion-col size="6" class="ion-no-padding">
          <div class="balance-item income">
            <ion-skeleton-text
              animated
              style="width: 80%; height: 20px; margin-top: 8px"
              class="fade-in"
            ></ion-skeleton-text>
            <ion-skeleton-text
              animated
              style="width: 60%; height: 24px"
              class="fade-in"
            ></ion-skeleton-text>
          </div>
        </ion-col>
        <ion-col size="6" class="ion-no-padding">
          <div class="balance-item expenses">
            <ion-skeleton-text
              animated
              style="width: 80%; height: 20px; margin-top: 8px"
              class="fade-in"
            ></ion-skeleton-text>
            <ion-skeleton-text
              animated
              style="width: 60%; height: 24px"
              class="fade-in"
            ></ion-skeleton-text>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ng-template>
</div>
